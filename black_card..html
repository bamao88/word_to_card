<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AIæ—¥æŠ¥å¡ç‰‡ç”Ÿæˆå™¨ - å°çº¢ä¹¦ç‰ˆ</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            background-color: #1a1a1a;
            color: #e0e0e0;
        }
        
        .controls {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #2d2d2d;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid #404040;
        }
        
        .instructions {
            background-color: #1e3a5f;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            text-align: left;
            max-width: 600px;
            margin: 0 auto 20px;
            border: 1px solid #2c5282;
        }
        
        .instructions h3 {
            margin-top: 0;
            color: #64b5f6;
        }
        
        .instructions ol {
            margin: 10px 0;
            padding-left: 20px;
            color: #b0bec5;
        }
        
        .export-btn {
            background-color: #ff4757;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
            transition: all 0.3s;
            box-shadow: 0 2px 8px rgba(255, 71, 87, 0.3);
        }
        
        .export-btn:hover {
            background-color: #ff3742;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(255, 71, 87, 0.4);
        }
        
        .export-btn:disabled {
            background-color: #555;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .canvas-method-btn {
            background-color: #2ed573;
            box-shadow: 0 2px 8px rgba(46, 213, 115, 0.3);
        }
        
        .canvas-method-btn:hover {
            background-color: #26d067;
            box-shadow: 0 4px 12px rgba(46, 213, 115, 0.4);
        }
        
        .status {
            margin-top: 15px;
            font-size: 14px;
            color: #b0bec5;
            min-height: 20px;
        }
        
        .card-container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            margin-bottom: 50px;
        }
        
        .card-wrapper {
            text-align: center;
        }
        
        .preview-card {
            width: 300px;
            height: 400px;
            background-color: #2d2d2d;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.4);
            cursor: pointer;
            transition: all 0.3s;
            overflow: hidden;
            position: relative;
            border: 1px solid #404040;
        }
        
        .preview-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.6);
            border-color: #555;
        }
        
        .preview-content {
            padding: 20px;
            font-size: 11px;
            line-height: 1.6;
            height: calc(100% - 60px);
            overflow: hidden;
            color: #e0e0e0;
            text-align: left;
        }
        
        .preview-page-number {
            position: absolute;
            bottom: 10px;
            right: 20px;
            font-size: 12px;
            color: #888;
        }
        
        .card-label {
            margin-top: 10px;
            font-size: 14px;
            color: #b0bec5;
        }
        
        /* Canvasç»˜åˆ¶åŒºåŸŸ */
        #canvasContainer {
            position: fixed;
            left: -9999px;
            top: 0;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #404040;
            border-top: 3px solid #ff4757;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            vertical-align: middle;
            margin-right: 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="controls">
        <h2>ğŸ¨ AIæ—¥æŠ¥ - å°çº¢ä¹¦å¡ç‰‡ç”Ÿæˆå™¨</h2>
        
        <div class="instructions">
            <h3>ğŸ“‹ ä½¿ç”¨è¯´æ˜</h3>
            <ol>
                <li>å¤åˆ¶æ­¤é¡µé¢çš„æ‰€æœ‰ä»£ç ï¼Œä¿å­˜ä¸º .html æ–‡ä»¶</li>
                <li>åœ¨æœ¬åœ°æµè§ˆå™¨æ‰“å¼€è¯¥æ–‡ä»¶</li>
                <li>ä½¿ç”¨ä¸‹æ–¹æŒ‰é’®ç”Ÿæˆå’Œä¸‹è½½å›¾ç‰‡</li>
            </ol>
            <p style="margin: 10px 0; color: #666;">
                ğŸ’¡ æç¤ºï¼šå¦‚æœåœ¨Claudeä¸­æ— æ³•ä¸‹è½½ï¼Œè¯·åœ¨æœ¬åœ°æµè§ˆå™¨ä¸­ä½¿ç”¨
            </p>
        </div>
        
        <div style="margin-top: 20px;">
            <button class="export-btn canvas-method-btn" onclick="generateWithCanvas()">
                ä½¿ç”¨Canvasç”Ÿæˆå›¾ç‰‡ï¼ˆæ¨èï¼‰
            </button>
            <button class="export-btn" onclick="generateAllCanvasImages()">
                æ‰¹é‡ç”Ÿæˆæ‰€æœ‰å›¾ç‰‡
            </button>
        </div>
        
        <div class="status" id="status">å‡†å¤‡å°±ç»ª</div>
    </div>
    
    <div class="card-container" id="cardContainer"></div>
    <div id="canvasContainer">
        <canvas id="renderCanvas"></canvas>
    </div>
    
    <script>
        const fullText = `Part 01ã€ç²¾é€‰èµ„è®¯ã€‘
ã€1ã€‘å¼ºåŒ–å­¦ä¹ ä¹‹çˆ¶Rich Sutton åœ¨WAICå‘å¸ƒäº†æœ€æ–°æ¼”è®²ã€Šä»æ•°æ®æ—¶ä»£åˆ°ç»éªŒæ—¶ä»£çš„ AIã€‹ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯ï¼šAIçš„è¿›åŒ–å°†ä»æ¶ˆåŒ–å­˜é‡"æ•°æ®"ï¼Œè½¬å‘é€šè¿‡ä¸ä¸–ç•Œäº¤äº’ã€ä¸»åŠ¨è·å–"ç»éªŒ"ã€‚
ç†è§£è¿™ä¸ªä»"æ•°æ®æ—¶ä»£"åˆ°"ç»éªŒæ—¶ä»£"çš„èŒƒå¼è½¬ç§»ï¼Œèƒ½å¸®æˆ‘ä»¬çœ‹æ¸…å½“å‰å¤§æ¨¡å‹èƒ½åŠ›çš„è¾¹ç•Œï¼Œå¹¶æ€è€ƒå¦‚ä½•æ„å»ºä¸‹ä¸€ä»£AIäº§å“ã€‚
è§†é¢‘é“¾æ¥ï¼šhttps://www.youtube.com/watch?v=Tp6XZL-C-c8
ã€2ã€‘æ™ºè°±AIå‘å¸ƒGLM-4.5ï¼šé¢å‘æ¨ç†ã€ä»£ç ä¸æ™ºèƒ½ä½“çš„å¼€æº SOTA æ¨¡å‹ã€‚æ¨¡å‹æƒé‡éµå¾ª MIT Licenseã€‚
å»ºè®®å¤§å®¶çœ‹çœ‹å®˜æ–¹å…¬å¸ƒçš„52é“é¢˜ç›®åŠAgentè½¨è¿¹å¹¶å°è¯•å¤ç°ï¼šhttps://huggingface.co/datasets/zai-org/CC-Bench-trajectories
å®˜æ–¹ä»‹ç»é“¾æ¥ï¼šhttps://mp.weixin.qq.com/s/Dh0r-O-WZAvlKaxQOXjlpQ
GitHub: https://github.com/zai-org/GLM-4.5
HuggingFace: https://huggingface.co/collections/zai-org/glm-45-687c621d34bda8c9e4bf503b
ModelScope: https://modelscope.cn/collections/GLM-45-b8693e2a08984f
API å·²ä¸Šçº¿å¼€æ”¾å¹³å° BigModel.cnï¼Œå¯ä»¥ä¸€é”®å…¼å®¹ Claude Code æ¡†æ¶ï¼Œä¹Ÿå¯ä»¥åœ¨æ™ºè°±æ¸…è¨€(chatglm.cn)å’ŒZ.aiå…è´¹ä½“éªŒæ»¡è¡€ç‰ˆã€‚

Part 02ã€å…¶ä»–è¡Œä¸šåŠ¨æ€ã€‘
1.ä¸–ç•Œäººå·¥æ™ºèƒ½å¤§ä¼šï¼ˆWAIC 2025ï¼‰çš„éƒ¨åˆ†çœ‹ç‚¹ã€‚
https://mp.weixin.qq.com/s/oeyURi8YKLxud2t_BV9Jyg
2.æ‰£å­æ­£å¼å®£å¸ƒæ‹¥æŠ±å¼€æºã€‚
https://mp.weixin.qq.com/s/6jGoaE29S2oOrywCAB8zMg?from=groupmessage&isappinstalled=0&scene=1&clicktime=1753675604&enterid=1753675604&click_id=4#wechat_redirect?wxwork_userid=ChenHang
3.èš‚èšæ•°ç§‘æ­£å¼å‘å¸ƒé‡‘èæ¨ç†å¤§æ¨¡å‹Agentar-Fin-R1ï¼ŒåŒæ—¶å‘å¸ƒFinovaå¤§æ¨¡å‹é‡‘èåº”ç”¨è¯„æµ‹åŸºå‡†ã€‚
https://mp.weixin.qq.com/s/FwstZ20-WT90F_kfSudWQQ
4.é€šä¹‰ä¸‡ç›¸2.2æ­£å¼å¼€æºï¼šå¼€æºæ–‡ç”Ÿè§†é¢‘Wan2.2-T2V-A14Bã€å›¾ç”Ÿè§†é¢‘Wan2.2-I2V-A14Bå’Œç»Ÿä¸€è§†é¢‘ç”ŸæˆWan2.2-TI2V-5Bã€‚
https://mp.weixin.qq.com/s/ivDFtXenaj4END34YPOFZw`;

        let pages = [];
        let currentPage = 0;

        // è®¡ç®—æ–‡æœ¬åœ¨canvasä¸Šçš„å®é™…é«˜åº¦
        function calculateTextHeight(ctx, text, maxWidth, lineHeight) {
            const lines = text.split('');
            let line = '';
            let lineCount = 0;
            
            for (let i = 0; i < lines.length; i++) {
                const testLine = line + lines[i];
                const metrics = ctx.measureText(testLine);
                
                if (metrics.width > maxWidth && line.length > 0) {
                    lineCount++;
                    line = lines[i];
                } else {
                    line = testLine;
                }
            }
            
            if (line.length > 0) {
                lineCount++;
            }
            
            return lineCount * lineHeight;
        }

        // æ”¹è¿›çš„æ–‡æœ¬ç»˜åˆ¶å‡½æ•°ï¼Œä¿®å¤é“¾æ¥æ¢è¡Œé—®é¢˜
        function drawLeftAlignedText(context, text, x, y, maxWidth, lineHeight) {
            context.save();
            
            const currentFont = context.font;
            if (currentFont.includes('bold')) {
                context.font = 'bold 36px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
            } else {
                context.font = '28px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
            }
            
            context.textAlign = 'left';
            context.textBaseline = 'top';
            
            const isURL = text.match(/^https?:\/\//);
            context.fillStyle = isURL ? '#888' : '#e0e0e0';
            
            let currentY = y;
            
            if (isURL) {
                // ä½¿ç”¨æ–°çš„URLæ¢è¡Œé€»è¾‘
                currentY = drawWrappedURL(context, text, x, currentY, maxWidth, lineHeight);
            } else {
                // éURLæ–‡æœ¬çš„æ¢è¡Œå¤„ç†
                currentY = drawWrappedText(context, text, x, currentY, maxWidth, lineHeight);
            }
            
            context.restore();
            return currentY;
        }

        // å®Œå…¨é‡å†™çš„URLæ¢è¡Œå‡½æ•°ï¼Œä¿®å¤æ¢è¡Œé—®é¢˜
        function drawWrappedURL(context, url, x, y, maxWidth, lineHeight) {
            let currentY = y;
            let currentLine = '';
            
            // å®šä¹‰åˆ†å‰²ç‚¹ï¼šåœ¨è¿™äº›å­—ç¬¦åä¼˜å…ˆæ¢è¡Œ
            const breakPoints = ['/', '?', '&', '=', '#', '-', '_'];
            
            // å°†URLè½¬æ¢ä¸ºå¸¦æœ‰æ½œåœ¨æ¢è¡Œç‚¹æ ‡è®°çš„æ•°ç»„
            let segments = [];
            let currentSegment = '';
            
            for (let i = 0; i < url.length; i++) {
                currentSegment += url[i];
                
                // å¦‚æœå½“å‰å­—ç¬¦æ˜¯åˆ†å‰²ç‚¹ï¼Œå°†å…¶ä½œä¸ºç‹¬ç«‹æ®µè½
                if (breakPoints.includes(url[i]) && i < url.length - 1) {
                    segments.push(currentSegment);
                    currentSegment = '';
                }
            }
            
            // æ·»åŠ æœ€åçš„æ®µè½
            if (currentSegment) {
                segments.push(currentSegment);
            }
            
            // é€æ®µå¤„ç†
            for (let segment of segments) {
                const testLine = currentLine + segment;
                const testMetrics = context.measureText(testLine);
                
                // å¦‚æœæ·»åŠ è¿™ä¸ªæ®µè½ä¼šè¶…å‡ºå®½åº¦
                if (testMetrics.width > maxWidth) {
                    // å¦‚æœå½“å‰è¡Œæœ‰å†…å®¹ï¼Œå…ˆç»˜åˆ¶å½“å‰è¡Œ
                    if (currentLine.length > 0) {
                        context.fillText(currentLine, x, currentY);
                        currentY += lineHeight;
                        currentLine = segment;
                        
                        // æ£€æŸ¥æ–°æ®µè½æœ¬èº«æ˜¯å¦ä¹Ÿå¤ªé•¿
                        const segmentMetrics = context.measureText(segment);
                        if (segmentMetrics.width > maxWidth) {
                            // å¯¹è¿‡é•¿çš„æ®µè½è¿›è¡Œå­—ç¬¦çº§åˆ†å‰²
                            const chars = segment.split('');
                            currentLine = '';
                            
                            for (let char of chars) {
                                const charTestLine = currentLine + char;
                                const charMetrics = context.measureText(charTestLine);
                                
                                if (charMetrics.width > maxWidth && currentLine.length > 0) {
                                    context.fillText(currentLine, x, currentY);
                                    currentY += lineHeight;
                                    currentLine = char;
                                } else {
                                    currentLine = charTestLine;
                                }
                            }
                        }
                    } else {
                        // å¦‚æœå½“å‰è¡Œä¸ºç©ºï¼Œä½†æ®µè½å¤ªé•¿ï¼Œè¿›è¡Œå­—ç¬¦çº§åˆ†å‰²
                        const chars = segment.split('');
                        for (let char of chars) {
                            const charTestLine = currentLine + char;
                            const charMetrics = context.measureText(charTestLine);
                            
                            if (charMetrics.width > maxWidth && currentLine.length > 0) {
                                context.fillText(currentLine, x, currentY);
                                currentY += lineHeight;
                                currentLine = char;
                            } else {
                                currentLine = charTestLine;
                            }
                        }
                    }
                } else {
                    // å¦‚æœä¸è¶…å‡ºå®½åº¦ï¼Œæ·»åŠ åˆ°å½“å‰è¡Œ
                    currentLine = testLine;
                }
            }
            
            // ç»˜åˆ¶æœ€åä¸€è¡Œï¼ˆå¦‚æœæœ‰å†…å®¹ï¼‰
            if (currentLine.length > 0) {
                context.fillText(currentLine, x, currentY);
                currentY += lineHeight;
            }
            
            return currentY;
        }

        // å¤„ç†æ™®é€šæ–‡æœ¬æ¢è¡Œçš„å‡½æ•°
        function drawWrappedText(context, text, x, y, maxWidth, lineHeight) {
            let currentY = y;
            let currentLine = '';
            
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                const testLine = currentLine + char;
                const metrics = context.measureText(testLine);
                
                if (metrics.width > maxWidth && currentLine.length > 0) {
                    context.fillText(currentLine, x, currentY);
                    currentY += lineHeight;
                    currentLine = char;
                } else {
                    currentLine = testLine;
                }
            }
            
            if (currentLine.length > 0) {
                context.fillText(currentLine, x, currentY);
                currentY += lineHeight;
            }
            
            return currentY;
        }

        // ç»˜åˆ¶æ ‡é¢˜çš„å‡½æ•°
        function drawTitle(context, x, y, maxWidth) {
            context.save();
            
            context.font = 'bold 72px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
            context.fillStyle = '#e0e0e0';
            context.textAlign = 'center';
            context.textBaseline = 'top';
            
            const title = 'AIäº§å“ç»ç†çš„è¡Œä¸šæ—¥æŠ¥';
            context.fillText(title, 450, y);
            
            context.restore();
            
            return y + 100;
        }

        function splitTextIntoPages() {
            const canvas = document.getElementById('renderCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = 900;
            canvas.height = 1200;
            
            const maxHeight = 1050; // ç•™å‡ºåº•éƒ¨é¡µç ç©ºé—´
            const x = 50;
            const maxWidth = 780; // å‡å°‘å®½åº¦ï¼Œä¸ºå³ä¾§ç•™å‡ºæ›´å¤šç©ºé—´
            
            const lines = fullText.split('\n');
            pages = [];
            let currentPageLines = [];
            let currentHeight = 80;
            
            // ç¬¬ä¸€é¡µéœ€è¦é¢å¤–è€ƒè™‘æ ‡é¢˜é«˜åº¦
            let isFirstPage = true;
            if (isFirstPage) {
                currentHeight = 180; // ä¸ºæ ‡é¢˜é¢„ç•™ç©ºé—´
            }
            
            for (let i = 0; i < lines.length; i++) {
                const line = lines[i];
                let lineHeight = 48;
                let extraSpacing = 0;
                
                // ä¸ºPartæ ‡é¢˜è®¾ç½®æ ·å¼
                if (line.includes('Part 01') || line.includes('Part 02')) {
                    ctx.font = 'bold 36px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
                    lineHeight = 54;
                    extraSpacing = 10; // Partæ ‡é¢˜å‰çš„é¢å¤–é—´è·
                } else {
                    ctx.font = '28px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
                }
                
                // è®¡ç®—è¿™ä¸€è¡Œéœ€è¦çš„é«˜åº¦
                let estimatedHeight = lineHeight;
                if (line.trim()) {
                    // å¦‚æœæ˜¯URLï¼Œéœ€è¦ç‰¹æ®Šè®¡ç®—é«˜åº¦
                    if (line.match(/^https?:\/\//)) {
                        // ä¼°ç®—URLå¯èƒ½éœ€è¦çš„è¡Œæ•°
                        const urlLength = ctx.measureText(line).width;
                        const estimatedLines = Math.ceil(urlLength / maxWidth);
                        estimatedHeight = estimatedLines * lineHeight;
                    } else {
                        estimatedHeight = calculateTextHeight(ctx, line, maxWidth, lineHeight);
                    }
                } else {
                    // ç©ºè¡Œ
                    estimatedHeight = 24;
                }
                
                // åŠ ä¸Šé¢å¤–é—´è·
                estimatedHeight += extraSpacing;
                
                // æ£€æŸ¥æ˜¯å¦éœ€è¦åˆ†é¡µ
                if (currentHeight + estimatedHeight > maxHeight) {
                    // éœ€è¦æ–°å»ºä¸€é¡µ
                    if (currentPageLines.length > 0) {
                        pages.push(currentPageLines.join('\n'));
                        currentPageLines = [];
                        currentHeight = 80; // é‡ç½®é«˜åº¦
                        isFirstPage = false;
                    }
                }
                
                // æ·»åŠ å½“å‰è¡Œåˆ°å½“å‰é¡µ
                currentPageLines.push(line);
                currentHeight += estimatedHeight;
            }
            
            // æ·»åŠ æœ€åä¸€é¡µ
            if (currentPageLines.length > 0) {
                pages.push(currentPageLines.join('\n'));
            }
            
            console.log(`æ€»å…±åˆ†æˆäº† ${pages.length} é¡µ`);
        }

        function renderPage(pageIndex) {
            const canvas = document.getElementById('renderCanvas');
            const ctx = canvas.getContext('2d');
            
            canvas.width = 900;
            canvas.height = 1200;
            
            // æš—è‰²èƒŒæ™¯
            ctx.fillStyle = '#1a1a1a';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            let y = 80;
            const x = 50;
            const maxWidth = 780; // å‡å°‘å®½åº¦ï¼Œä¸ºå³ä¾§ç•™å‡ºæ›´å¤šç©ºé—´
            
            // å¦‚æœæ˜¯ç¬¬ä¸€é¡µï¼Œç»˜åˆ¶æ ‡é¢˜
            if (pageIndex === 0) {
                y = drawTitle(ctx, x, 50, maxWidth);
                y += 30;
            }
            
            // ç»˜åˆ¶å†…å®¹
            const lines = pages[pageIndex].split('\n');
            
            lines.forEach(line => {
                if (line.includes('Part 01') || line.includes('Part 02')) {
                    // Partæ ‡é¢˜å‰å¢åŠ é—´è·
                    y += 10;
                    ctx.font = 'bold 36px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
                    y = drawLeftAlignedText(ctx, line, x, y, maxWidth, 54);
                } else if (line.trim()) {
                    ctx.font = '28px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
                    y = drawLeftAlignedText(ctx, line, x, y, maxWidth, 48);
                } else {
                    y += 24;
                }
            });
            
            // é¡µç 
            ctx.save();
            ctx.fillStyle = '#888';
            ctx.font = '20px "PingFang SC", "Microsoft YaHei", Arial, sans-serif';
            ctx.textAlign = 'right';
            ctx.textBaseline = 'top';
            ctx.fillText(`${pageIndex + 1}/${pages.length}`, 850, 1150);
            ctx.restore();
        }

        function downloadCanvasAsImage(pageIndex) {
            const canvas = document.getElementById('renderCanvas');
            canvas.toBlob(blob => {
                const link = document.createElement('a');
                link.download = `AIæ—¥æŠ¥_ç¬¬${pageIndex + 1}é¡µ.png`;
                link.href = URL.createObjectURL(blob);
                link.click();
                URL.revokeObjectURL(link.href);
            });
        }

        function generateWithCanvas() {
            if (pages.length === 0) splitTextIntoPages();
            
            updateStatus('<span class="loading"></span>æ­£åœ¨ç”Ÿæˆç¬¬1é¡µ...');
            renderPage(0);
            
            setTimeout(() => {
                downloadCanvasAsImage(0);
                updateStatus('ç”Ÿæˆå®Œæˆï¼ç‚¹å‡»é¢„è§ˆå¡ç‰‡å¯ç”Ÿæˆå…¶ä»–é¡µé¢');
            }, 100);
        }

        async function generateAllCanvasImages() {
            if (pages.length === 0) splitTextIntoPages();
            
            for (let i = 0; i < pages.length; i++) {
                updateStatus(`<span class="loading"></span>æ­£åœ¨ç”Ÿæˆç¬¬${i + 1}/${pages.length}é¡µ...`);
                renderPage(i);
                
                await new Promise(resolve => {
                    setTimeout(() => {
                        downloadCanvasAsImage(i);
                        resolve();
                    }, 500);
                });
            }
            
            updateStatus('æ‰€æœ‰å›¾ç‰‡ç”Ÿæˆå®Œæˆï¼');
        }

        function createPreviewCards() {
            splitTextIntoPages();
            const container = document.getElementById('cardContainer');
            container.innerHTML = ''; // æ¸…ç©ºå®¹å™¨
            
            pages.forEach((pageContent, index) => {
                const wrapper = document.createElement('div');
                wrapper.className = 'card-wrapper';
                
                const card = document.createElement('div');
                card.className = 'preview-card';
                card.onclick = () => {
                    updateStatus(`<span class="loading"></span>æ­£åœ¨ç”Ÿæˆç¬¬${index + 1}é¡µ...`);
                    renderPage(index);
                    setTimeout(() => {
                        downloadCanvasAsImage(index);
                        updateStatus('ç”Ÿæˆå®Œæˆï¼');
                    }, 100);
                };
                
                const content = document.createElement('div');
                content.className = 'preview-content';
                
                // å¦‚æœæ˜¯ç¬¬ä¸€é¡µï¼Œåœ¨é¢„è§ˆä¸­ä¹Ÿæ˜¾ç¤ºæ ‡é¢˜
                let displayContent = pageContent;
                if (index === 0) {
                    displayContent = '<strong style="font-size: 16px; display: block; text-align: center; margin-bottom: 15px;">AIäº§å“ç»ç†çš„è¡Œä¸šæ—¥æŠ¥</strong>' + pageContent;
                }
                
                content.innerHTML = displayContent
                    .replace(/\n/g, '<br>')
                    .replace(/Part 01ã€ç²¾é€‰èµ„è®¯ã€‘/g, '<strong style="font-size: 14px; color: #64b5f6;">Part 01ã€ç²¾é€‰èµ„è®¯ã€‘</strong>')
                    .replace(/Part 02ã€å…¶ä»–è¡Œä¸šåŠ¨æ€ã€‘/g, '<strong style="font-size: 14px; color: #64b5f6;">Part 02ã€å…¶ä»–è¡Œä¸šåŠ¨æ€ã€‘</strong>')
                    .replace(/(https?:\/\/[^\s<]+)/g, '<span style="color: #888;">$1</span>');
                
                const pageNumber = document.createElement('div');
                pageNumber.className = 'preview-page-number';
                pageNumber.textContent = `${index + 1}/${pages.length}`;
                
                card.appendChild(content);
                card.appendChild(pageNumber);
                
                const label = document.createElement('div');
                label.className = 'card-label';
                label.textContent = `ç¬¬ ${index + 1} é¡µ - ç‚¹å‡»ç”Ÿæˆå›¾ç‰‡`;
                
                wrapper.appendChild(card);
                wrapper.appendChild(label);
                container.appendChild(wrapper);
            });
        }

        function updateStatus(message) {
            document.getElementById('status').innerHTML = message;
        }

        // åˆå§‹åŒ–
        window.onload = function() {
            createPreviewCards();
            updateStatus(`å‡†å¤‡å°±ç»ªï¼Œå…± ${pages.length} é¡µ`);
        };
    </script>
</body>
</html>